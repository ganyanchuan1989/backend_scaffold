{"version":3,"file":"js/leave.9fb4e9ec.js","mappings":"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","sources":["webpack://hrms_frontend/./src/service/employeeService.js","webpack://hrms_frontend/./src/utils/myUtils.js","webpack://hrms_frontend/./src/views/leave/LeaveAdd.vue","webpack://hrms_frontend/./src/views/leave/LeaveAdd.vue?73a9","webpack://hrms_frontend/./src/views/leave/LeaveList.vue","webpack://hrms_frontend/./src/views/leave/LeaveList.vue?22e1"],"sourcesContent":["import { request } from \"./request/request\";\n\nclass EmployeeService {\n  add(data) {\n    return request(\"/api/employee/add\", {\n      method: \"POST\",\n      data,\n    });\n  }\n  update(data) {\n    return request(\"/api/employee/update\", {\n      method: \"POST\",\n      data,\n    });\n  }\n  delete(data) {\n    return request(\"/api/employee/delete\", {\n      method: \"POST\",\n      data,\n    });\n  }\n  list() {\n    return request(\"/api/employee/list\", {\n      method: \"POST\",\n    });\n  }\n  listAll() {\n    return request(\"/api/employee/listAll\", {\n      method: \"POST\",\n    });\n  }\n  queryByCode(data) {\n    return request(\"/api/employee/queryByCode\", {\n      method: \"POST\",\n      data,\n    });\n  }\n  likeByCode(data) {\n    return request(\"/api/employee/likeByCode\", {\n      method: \"POST\",\n      data,\n    });\n  }\n\n  login(data) {\n    return request(\"/api/employee/login\", {\n      method: \"POST\",\n      data,\n    });\n  }\n\n  modifyPwd(data) {\n    return request(\"/api/employee/modifyPwd\", {\n      method: \"POST\",\n      data,\n    });\n  }\n\n  \n}\n\nexport default new EmployeeService();\n","export const setFieldsValue = (formState, data) => {\r\n  for (let key in formState) {\r\n    formState[key] = data[key];\r\n  }\r\n  return formState;\r\n};\r\n\r\n","<template>\r\n  <div>\r\n    <a-form\r\n      :model=\"formState\"\r\n      ref=\"formRef\"\r\n      autocomplete=\"off\"\r\n      @finish=\"onFinish\"\r\n      v-bind=\"formOneLayout\"\r\n    >\r\n      <a-form-item\r\n        label=\"员工姓名\"\r\n        name=\"empCode\"\r\n        :rules=\"[{ required: true, message: '合同签订时间!' }]\"\r\n      >\r\n        <a-select v-model:value=\"formState.empCode\">\r\n          <template v-for=\"(item, index) in empState.value\" :key=\"index\">\r\n            <a-select-option :value=\"item.empCode\">{{\r\n              item.empName\r\n            }}</a-select-option>\r\n          </template>\r\n        </a-select>\r\n      </a-form-item>\r\n      <a-form-item\r\n        label=\"请假类型\"\r\n        name=\"leaveType\"\r\n        :rules=\"[{ required: true, message: '请选择请假开始时间!' }]\"\r\n      >\r\n        <a-select v-model:value=\"formState.leaveType\">\r\n          <template\r\n            v-for=\"(item, index) in getDictDataByKey('hrms_leave_type')\"\r\n            :key=\"index\"\r\n          >\r\n            <a-select-option :value=\"item.dataDictValue\">{{\r\n              item.dataDictLabel\r\n            }}</a-select-option>\r\n          </template>\r\n        </a-select>\r\n      </a-form-item>\r\n\r\n      <a-form-item\r\n        label=\"请假开始时间\"\r\n        name=\"leaveStartDate\"\r\n        :rules=\"[{ required: true, message: '请选择请假开始时间!' }]\"\r\n      >\r\n        <a-date-picker\r\n          v-model:value=\"formState.leaveStartDate\"\r\n          value-format=\"YYYY-MM-DD\"\r\n        />\r\n      </a-form-item>\r\n      <a-form-item\r\n        label=\"请假结束时间\"\r\n        name=\"leaveEndDate\"\r\n        :rules=\"[{ required: true, message: '请选择请假开始时间!' }]\"\r\n      >\r\n        <a-date-picker\r\n          v-model:value=\"formState.leaveEndDate\"\r\n          value-format=\"YYYY-MM-DD\"\r\n        />\r\n      </a-form-item>\r\n      <a-form-item\r\n        label=\"请假天数\"\r\n        name=\"leaveDay\"\r\n        :rules=\"[{ required: true, message: '请选择请假开始时间!' }]\"\r\n      >\r\n        <a-input v-model:value=\"formState.leaveDay\" />\r\n      </a-form-item>\r\n      <a-form-item\r\n        label=\"请假事由\"\r\n        name=\"leaveDesc\"\r\n        :rules=\"[{ required: true, message: '请输入请假简介!' }]\"\r\n      >\r\n        <a-textarea v-model:value=\"formState.leaveDesc\" />\r\n      </a-form-item>\r\n\r\n      <a-form-item :wrapper-col=\"{ offset: 8, span: 16 }\">\r\n        <a-button type=\"primary\" html-type=\"submit\">保存</a-button>\r\n      </a-form-item>\r\n    </a-form>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport employeeService from \"@/service/employeeService\";\r\nimport { reactive, ref, onMounted } from \"vue\";\r\nimport leaveService from \"@/service/leaveService\";\r\nimport { message } from \"ant-design-vue\";\r\nimport { useRoute, useRouter } from \"vue-router\";\r\nimport { OPERATE, formOneLayout } from \"@/utils/constant\";\r\nimport { setFieldsValue } from \"@/utils/myUtils\";\r\nimport { getDictDataByKey } from \"@/utils/dataDictUtil\";\r\n\r\nconst route = useRoute();\r\nconst router = useRouter();\r\n\r\nlet operate = OPERATE.ADD;\r\nlet cache = null;\r\n\r\nlet formState = reactive({\r\n  empCode: undefined,\r\n  leaveType: undefined,\r\n  leaveStartDate: undefined,\r\n  leaveEndDate: undefined,\r\n  leaveDay: 1,\r\n  leaveDesc: undefined,\r\n});\r\n\r\nconst empState = reactive({\r\n  value: [],\r\n});\r\n\r\nconst formRef = ref();\r\n\r\nconst onFinish = async (values) => {\r\n  if (operate === OPERATE.UPDATE) {\r\n    values = { ...cache, ...values };\r\n    const ret = await leaveService.update(values);\r\n    message.info(\"修改成功：\" + ret.leaveCode);\r\n    router.back();\r\n  } else {\r\n    const ret = await leaveService.add(values);\r\n    message.info(\"新增成功：\" + ret.leaveCode);\r\n    formRef.value.resetFields();\r\n  }\r\n};\r\n\r\nonMounted(async () => {\r\n  queryAllEmployee();\r\n  if (route.params.code) {\r\n    operate = OPERATE.UPDATE; // 修改\r\n    cache = await leaveService.queryByCode({ leaveCode: route.params.code });\r\n    setFieldsValue(formState, { ...cache });\r\n  }\r\n});\r\n\r\nconst queryAllEmployee = async () => {\r\n  empState.value = await employeeService.list();\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>\r\n","import script from \"./LeaveAdd.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./LeaveAdd.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__","<template>\r\n  <div>\r\n    <a-form\r\n      :model=\"formState\"\r\n      name=\"basic\"\r\n      autocomplete=\"off\"\r\n      @finish=\"onFinish\"\r\n      v-bind=\"formOneLayout\"\r\n      ref=\"formRef\"\r\n    >\r\n      <a-form-item\r\n        label=\"请假ID\"\r\n        name=\"leaveId\"\r\n        :rules=\"[{ required: true, message: '请输入请假ID!' }]\"\r\n      >\r\n        <a-input v-model:value=\"formState.leaveId\" />\r\n      </a-form-item>\r\n      <a-form-item :wrapper-col=\"{ offset: 8, span: 16 }\">\r\n        <a-button type=\"primary\" html-type=\"submit\">查询</a-button>\r\n        <a-button @click=\"resetForm\" style=\"margin-left: 10px\">重置</a-button>\r\n      </a-form-item>\r\n    </a-form>\r\n    <a-table :dataSource=\"dataSource\" :columns=\"columns\">\r\n      <template #bodyCell=\"{ column, record }\">\r\n        <template v-if=\"column.dataIndex === 'operation' && !disabled\">\r\n          <template v-if=\"!isApprove\">\r\n            <a @click=\"updateJob(record)\">修改</a> |\r\n            <a-popconfirm\r\n              v-if=\"dataSource.length\"\r\n              title=\"确定要删除吗?\"\r\n              @confirm=\"deleteDataDict(record)\"\r\n            >\r\n              <a>删除</a>\r\n            </a-popconfirm>\r\n          </template>\r\n          <template v-else>\r\n            <a @click=\"handleLeaveApprove(record, APPROVE_STATUS.AGREE)\"\r\n              >同意</a\r\n            >\r\n            |\r\n            <a @click=\"handleLeaveApprove(record, APPROVE_STATUS.REJECT)\"\r\n              >拒绝</a\r\n            >\r\n          </template>\r\n        </template>\r\n        <template v-if=\"column.dataIndex === 'leaveType'\">\r\n          {{ getDictDataNameByKeyValue(\"hrms_leave_type\", record.leaveType) }}\r\n        </template>\r\n        <template v-if=\"column.dataIndex === 'approvalStatus'\">\r\n          {{ getDictDataNameByKeyValue(\"approval_status\", record.approvalStatus) }}\r\n        </template>\r\n      </template>\r\n    </a-table>\r\n  </div>\r\n</template>\r\n\r\n<script setup>\r\nimport { onMounted, reactive, ref } from \"vue\";\r\nimport leaveService from \"@/service/leaveService\"; //引入路由函数\r\nimport { useRouter, useRoute } from \"vue-router\";\r\nimport { message } from \"ant-design-vue\";\r\nimport { DATA_STATUS, formOneLayout, APPROVE_STATUS } from \"@/utils/constant\";\r\nimport { getUserInfo } from \"@/utils/authUtil\";\r\nimport { getDictDataNameByKeyValue } from \"@/utils/dataDictUtil\";\r\n\r\nconst router = useRouter();\r\nconst route = useRoute();\r\n\r\nconst columns = [\r\n  { title: \"请假ID\", dataIndex: \"leaveId\", key: \"leaveId\" },\r\n  { title: \"请假类型\", dataIndex: \"leaveType\", key: \"leaveType\" },\r\n  { title: \"开始时间\", dataIndex: \"leaveStartDate\", key: \"leaveStartDate\" },\r\n  { title: \"结束时间\", dataIndex: \"leaveEndDate\", key: \"leaveEndDate\" },\r\n  { title: \"请假事由\", dataIndex: \"leaveDesc\", key: \"leaveDesc\" },\r\n  { title: \"审批状态\", dataIndex: \"approvalStatus\", key: \"approvalStatus\" },\r\n  { title: \"操作\", dataIndex: \"operation\" },\r\n];\r\n\r\nconst dataSource = ref([]);\r\nconst formRef = ref();\r\n\r\nlet formState = reactive({\r\n  leaveId: \"\",\r\n});\r\n\r\nconst disabled = ref(false);\r\nconst isApprove = ref(false);\r\n\r\nconst onFinish = async (values) => {\r\n  if (route.fullPath === \"/leave/my\") {\r\n    disabled.value = true;\r\n    dataSource.value = await leaveService.listByEmpCode({\r\n      ...values,\r\n      empCode: getUserInfo().empCode,\r\n    });\r\n  } else {\r\n    dataSource.value = await leaveService.likeByCode(values);\r\n  }\r\n};\r\n\r\nconst resetForm = async () => {\r\n  formRef.value.resetFields();\r\n  queryAll();\r\n};\r\n\r\nonMounted(async () => {\r\n  queryAll();\r\n});\r\n\r\nconst updateJob = (record) => {\r\n  router.push({\r\n    path: `/leave/update/${record.leaveId}`,\r\n  });\r\n};\r\n\r\nconst queryAll = async () => {\r\n  if (route.fullPath === \"/leave/my\") {\r\n    disabled.value = true;\r\n    dataSource.value = await leaveService.listByEmpCode({\r\n      empCode: getUserInfo().empCode,\r\n    });\r\n  } else if (route.fullPath === \"/leave/approve\") {\r\n    isApprove.value = true;\r\n    dataSource.value = await leaveService.queryDeptUnapprovalLeave({\r\n      deptCode: getUserInfo().deptCode,\r\n    });\r\n  } else {\r\n    dataSource.value = await leaveService.list();\r\n  }\r\n};\r\n\r\nconst deleteDataDict = async (record) => {\r\n  await leaveService.delete({ ...record, dataStatus: DATA_STATUS.DELETE });\r\n  message.info(\"删除成功：\" + record.leaveId);\r\n  queryAll();\r\n};\r\n\r\nconst handleLeaveApprove = async (record, approvalStatus) => {\r\n  await leaveService.update({ ...record, approvalStatus });\r\n  message.info(\"处理成功：\" + record.leaveId);\r\n  queryAll();\r\n};\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>\r\n","import script from \"./LeaveList.vue?vue&type=script&setup=true&lang=js\"\nexport * from \"./LeaveList.vue?vue&type=script&setup=true&lang=js\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["EmployeeService","add","data","request","method","update","delete","list","listAll","queryByCode","likeByCode","login","modifyPwd","setFieldsValue","formState","key","route","useRoute","router","useRouter","operate","OPERATE","cache","reactive","empCode","undefined","leaveType","leaveStartDate","leaveEndDate","leaveDay","leaveDesc","empState","value","formRef","ref","onFinish","async","values","ret","leaveService","message","leaveCode","back","resetFields","onMounted","queryAllEmployee","params","code","employeeService","__exports__","columns","title","dataIndex","dataSource","leaveId","disabled","isApprove","fullPath","getUserInfo","resetForm","queryAll","updateJob","record","push","path","deptCode","deleteDataDict","dataStatus","DATA_STATUS","handleLeaveApprove","approvalStatus"],"sourceRoot":""}